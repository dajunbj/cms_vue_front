{"ast":null,"code":"import Vue from \"vue\";\nimport Router from \"vue-router\";\nimport HomeView from \"../views/HomeView.vue\";\nimport UserView from \"../views/UserView.vue\";\nimport SettingView from \"../views/SettingView.vue\";\nimport LoginView from \"../views/LoginView.vue\";\nVue.use(Router);\nconst router = new Router({\n  mode: \"history\",\n  routes: [{\n    path: \"/\",\n    redirect: \"/login\"\n  }, {\n    path: \"/login\",\n    name: \"Login\",\n    component: LoginView\n  }, {\n    path: \"/home\",\n    name: \"Home\",\n    component: HomeView,\n    meta: {\n      requiresAuth: true\n    }\n  },\n  //当用户导航到某个路由时，Vue Router 会将该路由的 meta 数据绑定到导航守卫的 to 参数上\n  {\n    path: \"/user\",\n    name: \"User\",\n    component: UserView,\n    meta: {\n      requiresAuth: true\n    }\n  }, {\n    path: \"/setting\",\n    name: \"Setting\",\n    component: SettingView,\n    meta: {\n      requiresAuth: true\n    }\n  }]\n});\n\n// 全局Routerの追加\nrouter.beforeEach((to, from, next) => {\n  const isAuthenticated = !!sessionStorage.getItem(\"token\"); // 假设通过 token 判断登录状态\n\n  if (to.meta.requiresAuth && !isAuthenticated) {\n    alert(\"ログインせずにシステムへアクセスした。\");\n    return next(\"/login\"); // \n  }\n  const token = sessionStorage.getItem(\"token\");\n  const tokenExpiration = sessionStorage.getItem(\"tokenExpiration\");\n  const now = new Date().getTime();\n\n  // 如果目标路由需要认证\n  if (to.meta.requiresAuth) {\n    // 检查 Token 是否存在且未过期\n    if (!token || tokenExpiration && now > tokenExpiration) {\n      alert(\"登录状态已过期，请重新登录\");\n      sessionStorage.clear(); // sessionStorageをクリアする\n      return next(\"/login\"); // ログインせずにシステムの画面へアクセスしたい場合、直接にログイン画面へアクセスする\n    }\n  }\n  next(); // 放行\n});\nexport default router;","map":{"version":3,"names":["Vue","Router","HomeView","UserView","SettingView","LoginView","use","router","mode","routes","path","redirect","name","component","meta","requiresAuth","beforeEach","to","from","next","isAuthenticated","sessionStorage","getItem","alert","token","tokenExpiration","now","Date","getTime","clear"],"sources":["D:/soft/workspace/cms_vue_front/src/router/index.js"],"sourcesContent":["import Vue from \"vue\";\r\nimport Router from \"vue-router\";\r\nimport HomeView from \"../views/HomeView.vue\";\r\nimport UserView from \"../views/UserView.vue\";\r\nimport SettingView from \"../views/SettingView.vue\";\r\nimport LoginView from \"../views/LoginView.vue\";\r\n\r\nVue.use(Router);\r\n\r\nconst router = new Router({\r\n  mode: \"history\",\r\n  routes: [\r\n    { path: \"/\", redirect: \"/login\" },\r\n    { path: \"/login\", name: \"Login\", component: LoginView },\r\n    { path: \"/home\", name: \"Home\", component: HomeView, meta: { requiresAuth: true } },//当用户导航到某个路由时，Vue Router 会将该路由的 meta 数据绑定到导航守卫的 to 参数上\r\n    { path: \"/user\", name: \"User\", component: UserView, meta: { requiresAuth: true } },\r\n    { path: \"/setting\", name: \"Setting\", component: SettingView, meta: { requiresAuth: true } },\r\n  ],\r\n});\r\n\r\n// 全局Routerの追加\r\nrouter.beforeEach((to, from, next) => {\r\n  const isAuthenticated = !!sessionStorage.getItem(\"token\"); // 假设通过 token 判断登录状态\r\n  \r\n  if (to.meta.requiresAuth && !isAuthenticated) {\r\n    alert(\"ログインせずにシステムへアクセスした。\");\r\n    return next(\"/login\"); // \r\n  }\r\n  \r\n  const token = sessionStorage.getItem(\"token\");\r\n  const tokenExpiration = sessionStorage.getItem(\"tokenExpiration\");\r\n  const now = new Date().getTime();\r\n\r\n  // 如果目标路由需要认证\r\n  if (to.meta.requiresAuth) {\r\n    // 检查 Token 是否存在且未过期\r\n    if (!token || (tokenExpiration && now > tokenExpiration)) {\r\n      alert(\"登录状态已过期，请重新登录\");\r\n      sessionStorage.clear(); // sessionStorageをクリアする\r\n      return next(\"/login\"); // ログインせずにシステムの画面へアクセスしたい場合、直接にログイン画面へアクセスする\r\n    }\r\n  }\r\n\r\n  next(); // 放行\r\n});\r\n\r\nexport default router;"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,MAAM,MAAM,YAAY;AAC/B,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,QAAQ,MAAM,uBAAuB;AAC5C,OAAOC,WAAW,MAAM,0BAA0B;AAClD,OAAOC,SAAS,MAAM,wBAAwB;AAE9CL,GAAG,CAACM,GAAG,CAACL,MAAM,CAAC;AAEf,MAAMM,MAAM,GAAG,IAAIN,MAAM,CAAC;EACxBO,IAAI,EAAE,SAAS;EACfC,MAAM,EAAE,CACN;IAAEC,IAAI,EAAE,GAAG;IAAEC,QAAQ,EAAE;EAAS,CAAC,EACjC;IAAED,IAAI,EAAE,QAAQ;IAAEE,IAAI,EAAE,OAAO;IAAEC,SAAS,EAAER;EAAU,CAAC,EACvD;IAAEK,IAAI,EAAE,OAAO;IAAEE,IAAI,EAAE,MAAM;IAAEC,SAAS,EAAEX,QAAQ;IAAEY,IAAI,EAAE;MAAEC,YAAY,EAAE;IAAK;EAAE,CAAC;EAAC;EACnF;IAAEL,IAAI,EAAE,OAAO;IAAEE,IAAI,EAAE,MAAM;IAAEC,SAAS,EAAEV,QAAQ;IAAEW,IAAI,EAAE;MAAEC,YAAY,EAAE;IAAK;EAAE,CAAC,EAClF;IAAEL,IAAI,EAAE,UAAU;IAAEE,IAAI,EAAE,SAAS;IAAEC,SAAS,EAAET,WAAW;IAAEU,IAAI,EAAE;MAAEC,YAAY,EAAE;IAAK;EAAE,CAAC;AAE/F,CAAC,CAAC;;AAEF;AACAR,MAAM,CAACS,UAAU,CAAC,CAACC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACpC,MAAMC,eAAe,GAAG,CAAC,CAACC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;;EAE3D,IAAIL,EAAE,CAACH,IAAI,CAACC,YAAY,IAAI,CAACK,eAAe,EAAE;IAC5CG,KAAK,CAAC,qBAAqB,CAAC;IAC5B,OAAOJ,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;EACzB;EAEA,MAAMK,KAAK,GAAGH,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;EAC7C,MAAMG,eAAe,GAAGJ,cAAc,CAACC,OAAO,CAAC,iBAAiB,CAAC;EACjE,MAAMI,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;;EAEhC;EACA,IAAIX,EAAE,CAACH,IAAI,CAACC,YAAY,EAAE;IACxB;IACA,IAAI,CAACS,KAAK,IAAKC,eAAe,IAAIC,GAAG,GAAGD,eAAgB,EAAE;MACxDF,KAAK,CAAC,eAAe,CAAC;MACtBF,cAAc,CAACQ,KAAK,CAAC,CAAC,CAAC,CAAC;MACxB,OAAOV,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;IACzB;EACF;EAEAA,IAAI,CAAC,CAAC,CAAC,CAAC;AACV,CAAC,CAAC;AAEF,eAAeZ,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}